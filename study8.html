

이벤트 : 사용자의 입력 행위나 문서나 브라우저의 상태변화를 자바스크립트 코드에게 알리는 통지(notification)

이벤트 리스너 : 발생한 이벤트에 대처하기 위해 작성된 자바스크립트 코드



이벤트 리스너 만들기

1. HTML 태그 내에 이벤트 리스너 작성
    <p onmouseover = "this.style.backgroundColor='orchid'"
       onmouseout = "this.style.backgroundColor='white'">
    </p>

2. DOM 객체의 이벤트 리스너 프로퍼티에 작성
    function over() { 
        // onmouseover 리스너로 사용할 함수
    }
    let p = document.getElementById("p");
    p.onmouseover = over; // onmouseover 리스너로 over() 함수 등록
    p.onmouseover = over(); // 잘못된 코드

3. DOM 객체의 addEventListener() 메소드 활용
    p.addEventListener("mouseover", over); // onmouseover 리스너로 over() 등록

4. 익명 함수 사용
    p.onmouseover = function () { this.style.backgroundColor = "orchid"; }; 
    p.addEventListener("mouseover", function () { this.style.backgroundColor = "orchid"; } );





이벤트 객체
- 발생한 이벤트에 관련된 다양한 정보를 담은 객체
- 이벤트가 처리되고 나면 이벤트 객체 소멸
- 이벤트 객체는 이벤트 리스너 함수의 첫 번째 매개변수에 전달

1.
function f(e) { // 매개변수 e에 이벤트 객체 전달받음 }
obj.onclick = f; 

2. 
obj.onclick = function(e) { // 매개변수 e에 이벤트 객체 전달받음 }

3.
function f(e) { }
<button onclick="f(event)"> 버튼 </button>
<div onclick="alert(event.type)"> 버튼 </div>


이벤트 객체에 들어 있는 정보
e.type = 이벤트 종류(click, load 등)
e.target = 이벤트를 발생시킨 객체
e.currentTarget = 현재 이벤트를 실행시키는 객체
e.defaultPrevented = 이벤트의 디폴트 행동이 취소되었는지를 나타내는 true/false 값

이벤트의 디폴트 행동이란?
- <a>의 click 이벤트의 디폴트 행동 : 웹 페이지 이동
- submit 버튼의 click 이벤트의 디폴트 행동 : 폼 데이터 전송
- <input type=“checkbox”>의 click 이벤트의 디폴트 행동 : 체크박스선택
<a href="http://www.naver.com" onclick="return false"> 이동 안되는 링크 </a>
<a href="http://www.naver.com" onclick="event.preventDefault();"> 이동 안되는 링크 </a>
function noAction(e) { 
    e.preventDefault(); // 이벤트의 디폴트 행동 강제취소
}





이벤트 흐름
- 이벤트가 발생하면 window 객체에 먼저 도달하고, DOM 트리를 따라 이벤트 타겟에 도착하고, 
  다시 반대 방향으로 흘러 window 객체에 도달한 다음 사라지는 과정

캡쳐 단계
- 이벤트가 window 객체에서 중간의 모든 DOM 객체를 거쳐 타겟 객체에 전달되는 과정
- 이벤트가 거쳐가는 모든 DOM 객체(window포함)의 이벤트 리스너 실행
버블 단계
- 이벤트가 타겟에서 중간의 모든 DOM 객체를 거쳐 window 객체에 전달되는 과정
- 이벤트가 거쳐가는 모든 DOM 객체(window포함)의 이벤트 리스너 실행

DOM 객체에는 캡쳐 리스너와 버블 리스너 두 개 모두 작성할 수 있음
- addEventListener()의 3 번째 매개 변수 이용
- true이면 캡쳐 리스너, false이면 버블 리스너
- 생략되면 false로 처리
    let b = document.getElementById("button");
    b.addEventListener("click", capFunc, true); // 캡쳐 단계에서 capFunc() 실행
    b.addEventListener("click", bubbleFunc, false); // 버블 단계에서 bubbleFunc() 실행

    obj.onclick = function(e) { // 버블 리스너도 작동 }

이벤트 흐름을 중단시키기
event.stopPropagation(); // event가 이벤트 객체일 때




마우스 관련 이벤트 리스너 호출 경우
◼ onmousedown : 마우스 버튼을 누르는 순간
◼ onmouseup : 눌러진 버튼이 놓여지는 순간
◼ onmouseover : 마우스가 태그 위로 올라오는 순간. 자식 영역 포함
◼ onmouseout : 마우스가 태그 위로 올라오는 순간. 자식 영역 포함
◼ onmouseenter : 마우스가 태그 위로 올라오는 순간. 버블 단계 없음
◼ onmouseleave : 마우스가 태그 위로 올라오는 순간. 버블 단계 없음
◼ onwheel : HTML 태그에 마우스 휠이 구르는 동안 계속 호출 / 위쪽으로 굴린 경우 양수 / 아래쪽으로 굴린 경우 음수

obj.onwheel = function (e) {
    if(e.wheelDelta < 0) { // 아래쪽으로 휠을 굴린 경우 }
    else { // 위쪽으로 휠을 굴린 경우 }
};

◼ oncontextmenu
HTML 태그 위에 마우스 우클릭시 디폴트로 컨텍스트 메뉴(context menu) 출력 / 메뉴창 같은 거
우클릭시 oncontextmenu 리스너가 먼저 호출
document.oncontextmenu = function () { return false; // 우클릭 금지 }

◼ onload
웹 페이지의 로딩 완료시 호출되는 이벤트 리스너
window.onload = function() { alert(‘hello’); }
<body onload="alert('hello')">

-> 문제
myImg.src = "banana.png"; 실행 직후 이미지 로딩 완료되지 않음
let width = myImg.width; 이미지 로딩 완료 전일 때 myImg.width = 0임

-> 해결
myImg.onload = function () { // 이미지 로딩 완료 시 실행
    let width = myImg.width; // 정확한 이미지 폭 읽기
}

이미지 로딩
let bananaImg = new Image(); // 이미지 객체 생성
bananaImg.src = "banana.png"; // 이미지 로딩
let myImg = document.getElementById("myImg");
myImg.src = bananaImg.src; // 이미지 출력

◼ onblur : 포커스를 잃을 때 발생하는 이벤트 리스너
◼ onfocus : 포커스를 얻었을 때



라디오 버튼
function findChecked() {
    let found = null;
    let kcity = document.getElementsByName("city");
    for(let i=0; i<kcity.length; i++) {
        if(kcity[i].checked == true)
        found = kcity[i];
    }
    if(found != null)
        alert(found.value + "이 선택되었음");
    else
        alert("선택된 것이 없음");
}
<form>
    <input type="radio" name="city" value="seoul" checked>서울
    <input type="radio" name="city" value="busan">부산
    <input type="radio" name="city" value="chunchen">춘천
    <input type="button" value="find checked" onclick="findChecked()">
</form>


체크 박스
function calc(cBox) {
    if(cBox.checked)
        sum += parseInt(cBox.value);
    else
        sum -= parseInt(cBox.value);
        document.getElementById("sumtext").value = sum;
}
<form>
    <input type="checkbox" name="hap" value="10000" onclick="calc(this)">모자 1만원
    <input type="checkbox" name="shose" value="30000" onclick="calc(this)">구두 3만원
    <input type="checkbox" name="bag" value="80000" onclick="calc(this)">명품가방 8만원 <br> 지불하실 금액 
    <input type="text" id="sumtext" value="0" >
</form>


셀렉트 
<select id="fruits">
    <option value="1">딸기</option>
    <option value="2" selected>바나나</option>
    <option value="3">사과</option>
</select>

let sel = document.getElementById("fruits");
let index = sel.selectedIndex; // index는 선택 상태의 옵션 인덱스
sel.selectedIndex = 2; // 3번째 옵션 “사과” 선택
sel.options[2].selected = true; // 3번째 옵션 “사과” 선택

선택된 옵션이 변경되면 select 객체의 onchange 리스너 호출
<select id="fruits" onchange="drawImage()">...</select>



◼ onkeydown
  키가 눌러지는 순간 호출. 모든 키에 대해 작동
◼ onkeypress
  문자 키와 <Enter>, <Space>, <Esc> 키에 대해서만 눌러지는 순간에 추가 호출
  문자 키가 아닌 경우(<F1>, <Shift>, <PgDn>, <Del>, <Ins> 등) 호출되지 않음
◼ onkeyup
  눌러진 키가 떼어지는 순간 호출



◼ onreset
  reset 버튼(<input type="reset">) 클릭 시
  false를 리턴하면 폼이 초기화되지 않음
◼ onsubmit
  submit(<input type="submit">) 버튼 클릭 시
  false를 리턴하면 폼 전송하지 않음

  onreset과 onsubmit 리스너는 <form> 태그에 달아야 한다.
 <form onreset=" " onsubmit=" ">